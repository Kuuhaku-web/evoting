{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-5df0dc91ef8428482c3c84641155c2efcc4bbabc",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/Counter.sol": "project/contracts/Counter.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/Counter.sol": {
        "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.19;\n\n/**\n * @title BinusUKMVoting\n * @dev Smart Contract untuk E-Voting Unit Kegiatan Mahasiswa BINUS University\n */\ncontract BinusUKMVoting {\n    \n    // Struct untuk Kandidat\n    struct Candidate {\n        uint256 id;\n        string name;\n        string description;\n        string imageUrl;\n        uint256 voteCount;\n        bool isActive;\n    }\n    \n    // Struct untuk Kategori UKM\n    struct Category {\n        uint256 id;\n        string name;\n        string description;\n        bool isActive;\n        uint256 totalVotes;\n        uint256[] candidateIds;\n    }\n    \n    // State Variables\n    address public admin;\n    bool public votingActive;\n    uint256 public categoryCount;\n    uint256 public candidateCount;\n    \n    // Mappings\n    mapping(uint256 => Category) public categories;\n    mapping(uint256 => Candidate) public candidates;\n    mapping(uint256 => mapping(uint256 => bool)) public categoryHasCandidate; // categoryId => candidateId => exists\n    mapping(address => mapping(uint256 => bool)) public hasVoted; // voter => categoryId => hasVoted\n    mapping(address => mapping(uint256 => uint256)) public voterChoice; // voter => categoryId => candidateId\n    mapping(address => bool) public registeredVoters;\n    \n    // Events\n    event VoterRegistered(address indexed voter);\n    event CategoryCreated(uint256 indexed categoryId, string name);\n    event CandidateAdded(uint256 indexed candidateId, uint256 indexed categoryId, string name);\n    event VoteCast(address indexed voter, uint256 indexed categoryId, uint256 indexed candidateId);\n    event VotingStatusChanged(bool active);\n    event CandidateStatusChanged(uint256 indexed candidateId, bool active);\n    event CategoryStatusChanged(uint256 indexed categoryId, bool active);\n    \n    // Modifiers\n    modifier onlyAdmin() {\n        require(msg.sender == admin, \"Only admin can perform this action\");\n        _;\n    }\n    \n    modifier votingIsActive() {\n        require(votingActive, \"Voting is not active\");\n        _;\n    }\n    \n    modifier votingIsNotActive() {\n        require(!votingActive, \"Voting is currently active\");\n        _;\n    }\n    \n    modifier onlyRegisteredVoter() {\n        require(registeredVoters[msg.sender], \"You are not a registered voter\");\n        _;\n    }\n    \n    // Constructor\n    constructor() {\n        admin = msg.sender;\n        votingActive = false;\n        categoryCount = 0;\n        candidateCount = 0;\n    }\n    \n    // Admin Functions\n    \n    /**\n     * @dev Mengubah admin contract\n     */\n    function transferAdmin(address newAdmin) external onlyAdmin {\n        require(newAdmin != address(0), \"Invalid address\");\n        admin = newAdmin;\n    }\n    \n    /**\n     * @dev Memulai atau menghentikan voting\n     */\n    function toggleVoting() external onlyAdmin {\n        votingActive = !votingActive;\n        emit VotingStatusChanged(votingActive);\n    }\n    \n    /**\n     * @dev Membuat kategori UKM baru\n     */\n    function createCategory(\n        string memory _name,\n        string memory _description\n    ) external onlyAdmin votingIsNotActive returns (uint256) {\n        categoryCount++;\n        \n        categories[categoryCount] = Category({\n            id: categoryCount,\n            name: _name,\n            description: _description,\n            isActive: true,\n            totalVotes: 0,\n            candidateIds: new uint256[](0)\n        });\n        \n        emit CategoryCreated(categoryCount, _name);\n        return categoryCount;\n    }\n    \n    /**\n     * @dev Menambahkan kandidat ke kategori\n     */\n    function addCandidate(\n        uint256 _categoryId,\n        string memory _name,\n        string memory _description,\n        string memory _imageUrl\n    ) external onlyAdmin votingIsNotActive returns (uint256) {\n        require(_categoryId > 0 && _categoryId <= categoryCount, \"Invalid category\");\n        require(categories[_categoryId].isActive, \"Category is not active\");\n        \n        candidateCount++;\n        \n        candidates[candidateCount] = Candidate({\n            id: candidateCount,\n            name: _name,\n            description: _description,\n            imageUrl: _imageUrl,\n            voteCount: 0,\n            isActive: true\n        });\n        \n        categories[_categoryId].candidateIds.push(candidateCount);\n        categoryHasCandidate[_categoryId][candidateCount] = true;\n        \n        emit CandidateAdded(candidateCount, _categoryId, _name);\n        return candidateCount;\n    }\n    \n    /**\n     * @dev Mengaktifkan/menonaktifkan kandidat\n     */\n    function toggleCandidateStatus(uint256 _candidateId) external onlyAdmin {\n        require(_candidateId > 0 && _candidateId <= candidateCount, \"Invalid candidate\");\n        candidates[_candidateId].isActive = !candidates[_candidateId].isActive;\n        emit CandidateStatusChanged(_candidateId, candidates[_candidateId].isActive);\n    }\n    \n    /**\n     * @dev Mengaktifkan/menonaktifkan kategori\n     */\n    function toggleCategoryStatus(uint256 _categoryId) external onlyAdmin {\n        require(_categoryId > 0 && _categoryId <= categoryCount, \"Invalid category\");\n        categories[_categoryId].isActive = !categories[_categoryId].isActive;\n        emit CategoryStatusChanged(_categoryId, categories[_categoryId].isActive);\n    }\n    \n    /**\n     * @dev Mendaftarkan voter baru\n     */\n    function registerVoter(address _voter) external onlyAdmin {\n        require(_voter != address(0), \"Invalid address\");\n        require(!registeredVoters[_voter], \"Voter already registered\");\n        \n        registeredVoters[_voter] = true;\n        emit VoterRegistered(_voter);\n    }\n    \n    /**\n     * @dev Mendaftarkan multiple voters sekaligus\n     */\n    function registerVoters(address[] memory _voters) external onlyAdmin {\n        for (uint256 i = 0; i < _voters.length; i++) {\n            if (_voters[i] != address(0) && !registeredVoters[_voters[i]]) {\n                registeredVoters[_voters[i]] = true;\n                emit VoterRegistered(_voters[i]);\n            }\n        }\n    }\n    \n    // Voting Functions\n    \n    /**\n     * @dev Melakukan voting untuk kandidat dalam kategori tertentu\n     */\n    function vote(uint256 _categoryId, uint256 _candidateId) \n        external \n        votingIsActive \n        onlyRegisteredVoter \n    {\n        require(_categoryId > 0 && _categoryId <= categoryCount, \"Invalid category\");\n        require(categories[_categoryId].isActive, \"Category is not active\");\n        require(!hasVoted[msg.sender][_categoryId], \"You have already voted in this category\");\n        require(_candidateId > 0 && _candidateId <= candidateCount, \"Invalid candidate\");\n        require(candidates[_candidateId].isActive, \"Candidate is not active\");\n        require(categoryHasCandidate[_categoryId][_candidateId], \"Candidate not in this category\");\n        \n        // Record vote\n        hasVoted[msg.sender][_categoryId] = true;\n        voterChoice[msg.sender][_categoryId] = _candidateId;\n        candidates[_candidateId].voteCount++;\n        categories[_categoryId].totalVotes++;\n        \n        emit VoteCast(msg.sender, _categoryId, _candidateId);\n    }\n    \n    // View Functions\n    \n    /**\n     * @dev Mendapatkan detail kandidat\n     */\n    function getCandidate(uint256 _candidateId) \n        external \n        view \n        returns (\n            uint256 id,\n            string memory name,\n            string memory description,\n            string memory imageUrl,\n            uint256 voteCount,\n            bool isActive\n        ) \n    {\n        require(_candidateId > 0 && _candidateId <= candidateCount, \"Invalid candidate\");\n        Candidate memory candidate = candidates[_candidateId];\n        return (\n            candidate.id,\n            candidate.name,\n            candidate.description,\n            candidate.imageUrl,\n            candidate.voteCount,\n            candidate.isActive\n        );\n    }\n    \n    /**\n     * @dev Mendapatkan semua kandidat dalam kategori\n     */\n    function getCandidatesByCategory(uint256 _categoryId) \n        external \n        view \n        returns (uint256[] memory) \n    {\n        require(_categoryId > 0 && _categoryId <= categoryCount, \"Invalid category\");\n        return categories[_categoryId].candidateIds;\n    }\n    \n    /**\n     * @dev Mendapatkan detail kategori\n     */\n    function getCategory(uint256 _categoryId) \n        external \n        view \n        returns (\n            uint256 id,\n            string memory name,\n            string memory description,\n            bool isActive,\n            uint256 totalVotes,\n            uint256 candidateCount_\n        ) \n    {\n        require(_categoryId > 0 && _categoryId <= categoryCount, \"Invalid category\");\n        Category memory category = categories[_categoryId];\n        return (\n            category.id,\n            category.name,\n            category.description,\n            category.isActive,\n            category.totalVotes,\n            category.candidateIds.length\n        );\n    }\n    \n    /**\n     * @dev Cek apakah user sudah vote di kategori tertentu\n     */\n    function hasUserVoted(address _voter, uint256 _categoryId) \n        external \n        view \n        returns (bool) \n    {\n        return hasVoted[_voter][_categoryId];\n    }\n    \n    /**\n     * @dev Mendapatkan pilihan voter di kategori tertentu\n     */\n    function getUserVote(address _voter, uint256 _categoryId) \n        external \n        view \n        returns (uint256) \n    {\n        require(hasVoted[_voter][_categoryId], \"User has not voted in this category\");\n        return voterChoice[_voter][_categoryId];\n    }\n    \n    /**\n     * @dev Mendapatkan hasil voting untuk kategori\n     */\n    function getCategoryResults(uint256 _categoryId) \n        external \n        view \n        returns (\n            uint256[] memory candidateIds_,\n            uint256[] memory voteCounts,\n            string[] memory names\n        ) \n    {\n        require(_categoryId > 0 && _categoryId <= categoryCount, \"Invalid category\");\n        \n        uint256[] memory catCandidates = categories[_categoryId].candidateIds;\n        uint256 length = catCandidates.length;\n        \n        candidateIds_ = new uint256[](length);\n        voteCounts = new uint256[](length);\n        names = new string[](length);\n        \n        for (uint256 i = 0; i < length; i++) {\n            uint256 candidateId = catCandidates[i];\n            candidateIds_[i] = candidateId;\n            voteCounts[i] = candidates[candidateId].voteCount;\n            names[i] = candidates[candidateId].name;\n        }\n        \n        return (candidateIds_, voteCounts, names);\n    }\n    \n    /**\n     * @dev Mendapatkan total votes secara keseluruhan\n     */\n    function getTotalVotes() external view returns (uint256) {\n        uint256 total = 0;\n        for (uint256 i = 1; i <= categoryCount; i++) {\n            total += categories[i].totalVotes;\n        }\n        return total;\n    }\n    \n    /**\n     * @dev Cek apakah address adalah voter yang terdaftar\n     */\n    function isRegisteredVoter(address _voter) external view returns (bool) {\n        return registeredVoters[_voter];\n    }\n}"
      }
    }
  }
}